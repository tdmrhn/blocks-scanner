document.addEventListener('DOMContentLoaded',()=>{const table=document.querySelector('table tbody');const tableRows=Array.from(document.querySelectorAll('table tbody tr'));const rowCount=document.querySelector('.row-count');const searchInput=document.querySelector('.table-search');const titleSearchInput=document.querySelector('.title-search');const blockNameSearchInput=document.querySelector('.block-name-search');const filters=['category','postType','block','title'];const getSelectedValues=(filter)=>Array.from(document.querySelectorAll(`.${filter}-filter:checked`)).map(el=>el.value);const updateFilters=()=>{const searchText=searchInput.value.toLowerCase();let visibleRows=[];tableRows.forEach(row=>{const rowText=row.textContent.toLowerCase();const matchesFilters=filters.every(filter=>{const selectedValues=getSelectedValues(filter);if(!selectedValues.length)return!0;return filter==='title'?selectedValues.includes(row.querySelector('td:first-child').textContent.trim()):selectedValues.includes(row.dataset[filter])});const matchesSearch=!searchText||rowText.includes(searchText);const isVisible=matchesFilters&&matchesSearch;row.style.display=isVisible?'':'none';if(isVisible)visibleRows.push(row);});rowCount.textContent=visibleRows.length;filters.forEach(filter=>{document.querySelectorAll(`.${filter}-filter`).forEach(input=>{const value=input.value;const count=visibleRows.filter(row=>filter==='title'?row.querySelector('td:first-child').textContent.trim()===value:row.dataset[filter]===value).length;const filterItem=input.closest('.filter-item');filterItem.style.display=count===0&&!input.checked?'none':'';input.parentElement.querySelector('.count').textContent=count})})};const setupSearch=(searchInput,filterType)=>{searchInput.addEventListener('input',()=>{const searchText=searchInput.value.toLowerCase();document.querySelectorAll(`.${filterType}-filter`).forEach(input=>{const filterItem=input.closest('.filter-item');const label=input.parentElement.textContent.toLowerCase();if(label.includes(searchText)||input.checked){filterItem.style.display=''}else{filterItem.style.display='none'}})})};const setupSort=()=>{document.querySelectorAll('th').forEach(header=>{header.addEventListener('click',function(){const columnIndex=[...this.parentNode.children].indexOf(this);const type=this.dataset.type;const ascending=!this.classList.contains('asc');document.querySelectorAll('th').forEach(th=>th.classList.remove('asc','desc'));this.classList.add(ascending?'asc':'desc');const parseValue=(value)=>{if(type==='number')return parseFloat(value)||0;if(type==='date')return new Date(value);return value.toLowerCase()};[...table.rows].sort((a,b)=>{const aValue=parseValue(a.cells[columnIndex].textContent.trim());const bValue=parseValue(b.cells[columnIndex].textContent.trim());return ascending?aValue>bValue?1:-1:aValue<bValue?1:-1}).forEach(row=>table.appendChild(row))})})};searchInput.addEventListener('input',updateFilters);filters.forEach(filter=>document.querySelectorAll(`.${filter}-filter`).forEach(input=>input.addEventListener('change',updateFilters)));setupSearch(titleSearchInput,'title');setupSearch(blockNameSearchInput,'block');setupSort();updateFilters()})